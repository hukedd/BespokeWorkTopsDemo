var stage,layer,imgDataUrl,imgName,backLeftCurveYes,frontLeftCurveYes,backRightCurveYes,showGrid=!0,sinkPositionFromTop=350,sinkPositionFromFront=100,sinkPositionFromLeft=100,isSinkRequired=!1,defaultSinkWidth=730,defaultSinkLength=500,defaultAllSides=100,sinkTypes=[{name:"Single",width:648,length:404},{name:"Super Large Bowl",width:868,length:462},{name:"1.5 Duo Bowl",width:866,height:462},{name:"1.5 Desginer Bowl",width:866,length:482}],sinkMaterial=[{name:"Stainless Steel"},{name:"Acrylic"}],bowlHandlingTypes=[{name:"Left Hand Bowl / Right Hand Drainer"},{name:"Right Hand Bowl / Left Hand Drainer"}];const edgeThickness=5,gridSize=50,gridcolour="#000000";var coloursList=[{name:"Minerva Sparkling White",image:"minerva-sparkling-white.jpg",range:"minerva",invertcolours:!1,invertGrid:!1},{name:"Minerva Carrara White",image:"minerva-carrara-white.jpg",range:"minerva",invertcolours:!1,invertGrid:!1},{name:"Minerva Ice Crystal",image:"minerva-ice-crystal.jpg",range:"minerva",invertcolours:!1,invertGrid:!1},{name:"Minerva Grey Crystal",image:"minerva-grey-crystal.jpg",range:"minerva",invertcolours:!1,invertGrid:!1},{name:"Minerva Copper Fleck",image:"minerva-copper-fleck.jpg",range:"minerva",invertcolours:!1,invertGrid:!1},{name:"Minerva Ice Blue",image:"minerva-ice-blue.jpg",range:"minerva",invertcolours:!1,invertGrid:!1},{name:"Minerva Caramel Crunch",image:"minerva-caramel-crunch.jpg",range:"minerva",invertcolours:!1,invertGrid:!1},{name:"Minerva Peak Stone",image:"minerva-peak-stone.jpg",range:"minerva",invertcolours:!1,invertGrid:!0},{name:"Minerva Nimbus Grey",image:"minerva-nimbus-grey.jpg",range:"minerva",invertcolours:!0,invertGrid:!0},{name:"Minerva Concrete Haze",image:"minerva-concrete-haze.jpg",range:"minerva",invertcolours:!1,invertGrid:!1},{name:"Minerva Travertine Haze",image:"minerva-travertine-haze.jpg",range:"minerva",invertcolours:!1,invertGrid:!1},{name:"Minerva Silver Haze",image:"minerva-silver-haze.jpg",range:"minerva",invertcolours:!1,invertGrid:!1},{name:"Minerva Calcutta White",image:"minerva-calcutta-white.jpg",range:"minerva",invertcolours:!1,invertGrid:!1},{name:"Minerva White",image:"minerva-white.jpg",range:"minerva",invertcolours:!1,invertGrid:!1},{name:"Minerva Blue Venato",image:"minerva-blue-venato.jpg",range:"minerva",invertcolours:!1,invertGrid:!1},{name:"Minerva Chalk Venato",image:"minerva-chalk-venato.jpg",range:"minerva",invertcolours:!1,invertGrid:!1},{name:"Minerva Grey Storm",image:"minerva-grey-storm.jpg",range:"minerva",invertcolours:!1,invertGrid:!1},{name:"Minerva Marble Wash",image:"minerva-marble-wash.jpg",range:"minerva",invertcolours:!1,invertGrid:!1},{name:"Maia Iceberg",image:"maia-iceberg.jpg",range:"maia",invertcolours:!1,invertGrid:!1},{name:"Maia Snow Haze",image:"maia-snow-haze.jpg",range:"maia",invertcolours:!1,invertGrid:!1},{name:"Maia Cristallo",image:"maia-cristallo.jpg",range:"maia",invertcolours:!1,invertGrid:!1},{name:"Maia Vanilla",image:"maia-vanilla.jpg",range:"maia",invertcolours:!1,invertGrid:!1},{name:"Maia Calcite",image:"maia-calcite.jpg",range:"maia",invertcolours:!1,invertGrid:!1},{name:"Maia Beige Sparkle",image:"maia-beige-sparkle.jpg",range:"maia",invertcolours:!1,invertGrid:!1},{name:"Maia Fossil",image:"maia-fossil.jpg",range:"maia",invertcolours:!1,invertGrid:!1},{name:"Maia Cappuccino",image:"maia-cappuccino.jpg",range:"maia",invertcolours:!1,invertGrid:!1},{name:"Maia Latte",image:"maia-latte.jpg",range:"maia",invertcolours:!1,invertGrid:!1},{name:"Maia Brazillian Greige",image:"maia-brazillian-greige.jpg",range:"maia",invertcolours:!0,invertGrid:!0},{name:"Maia Lava",image:"maia-lava.jpg",range:"maia",invertcolours:!0,invertGrid:!0},{name:"Maia Mocha",image:"maia-mocha.jpg",range:"maia",invertcolours:!0,invertGrid:!0},{name:"Maia Greystone",image:"maia-greystone.jpg",range:"maia",invertcolours:!0,invertGrid:!0},{name:"Maia Galaxy",image:"maia-galaxy.jpg",range:"maia",invertcolours:!0,invertGrid:!0},{name:"Maia Vulcano",image:"maia-vulcano.jpg",range:"maia",invertcolours:!0,invertGrid:!0}];function loadColourDropdown(){var e,a=document.getElementById("rangeSelect"),n=a.options[a.selectedIndex].value;(e=document.getElementById("colourSelect")).innerHTML="",(r=document.createElement("option")).text="Select",r.value="0",e.appendChild(r);for(let a of coloursList){var r;if(a.range===n)(r=document.createElement("option")).text=a.name,r.value=a.name,e.appendChild(r)}(e=document.getElementById("colourSelect")).value="Minerva Copper Fleck",loadColourPreview()}function loadColourPreview(){document.getElementById("colourPreview").style.display="block";var e=document.getElementById("colourSelect"),a=document.getElementById("colourPreview"),n=e.options[e.selectedIndex].value;if("0"!==n){var r=coloursList.find((e=>e.name===n));a.src="./images/"+r.range+"-original/"+r.image,a.title=r.name}else a.src=""}function hideImg(){document.getElementById("colourPreview").style.display="none",imgDataUrl=""}function loadAdjustViewLabel(){var e=document.getElementById("percentValue"),a=document.getElementById("adjustView").value;e.innerHTML=10*a+"%";var n=document.getElementById("innerCanvasDiv");n.style.transformOrigin="0 0",n.style.transform=`scale(${10*a/100})`}loadColourDropdown(),loadAdjustViewLabel();const colourPreview=document.getElementById("colourPreview");function CreateCanvas(e,a,n){stage=new Konva.Stage({container:"konvaContainer",width:e,height:a}),layer=new Konva.Layer,stage.add(layer),drawGrid(n)}function createHRuler(e){var a=$(".hruler");a.html("");for(var n=0,r=0;n<(e+5)/5;n++,r++){var t=$("<div>");0==r?t.addClass("tickLabel").html(5*n):[1,3,5,7,9].indexOf(r)>-1?(t.addClass("tickMinor"),9==r&&(r=-1)):t.addClass("tickMajor"),a.append(t)}}function createVRuler(e){var a=$(".vruler");a.html("");for(var n=0,r=0;n<(e+5)/5;n++,r++){var t=$("<div>");0==r?t.addClass("tickLabel").html(5*n):[1,3,5,7,9].indexOf(r)>-1?(t.addClass("tickMinor"),9==r&&(r=-1)):t.addClass("tickMajor"),a.append(t);let i=32+(e-100)/100*50;document.getElementById("vruler").style.top=i+"px",document.getElementById("vruler").style.left="-"+(i-10)+"px"}}colourPreview.addEventListener("load",(e=>{var a=e.target.src,n=e.target.title;imgDataUrl=a,imgName=n}));var gridLayer=new Konva.Layer;function drawGrid(e){gridLayer.destroy();for(let e=0;e<stage.width();e+=50)gridLayer.add(new Konva.Line({points:[e,0,e,stage.height()],stroke:"#000000",strokeWidth:1}));for(let e=0;e<stage.height();e+=50)gridLayer.add(new Konva.Line({points:[0,e,stage.width(),e],stroke:"#000000",strokeWidth:1}));gridLayer.clearCache(),!0===e&&(gridLayer.cache(),gridLayer.filters([Konva.Filters.Invert])),stage.add(gridLayer)}const toggleGridCheckbox=document.getElementById("toggleGrid");toggleGridCheckbox.addEventListener("change",(function(){toggleGridCheckbox.checked?gridLayer.show():gridLayer.hide()})),toggleGridCheckbox.click();const toggleJoinCheckbox=document.getElementById("toggleJoin");toggleJoinCheckbox.addEventListener("change",(function(){toggleJoinCheckbox.checked?horizontalLayer.show():horizontalLayer.hide()}));const toggleSinkBoundaryCheckbox=document.getElementById("toggleSinkBoundary");toggleSinkBoundaryCheckbox.addEventListener("change",(function(){toggleSinkBoundaryCheckbox.checked?sinkBoundary.show():sinkBoundary.hide()}));const horizontalLayer=new Konva.Layer,verticalLayer=new Konva.Layer;function joinLines(){const e=[25,25];for(let a=150;a<=stage.height();a+=50){horizontalLayer.add(new Konva.Line({points:[12.5,a,stage.width(),a],stroke:"red",strokeWidth:2,dash:e}));break}for(let a=150;a<=stage.width();a+=50){verticalLayer.add(new Konva.Line({points:[a,12.5,a,stage.height()],stroke:"red",strokeWidth:2,dash:e}));break}horizontalLayer.clearCache(),stage.add(horizontalLayer)}var sinkBoundary=new Konva.Layer;function addSinkBoundary(e,a,n,r){(sinkBoundary=new Konva.Rect({x:defaultAllSides+n,y:a-defaultSinkLength-defaultAllSides,width:e-2*defaultAllSides-(n+r),height:defaultSinkLength,dash:[5,5],stroke:"blue"})).clearCache(),layer.add(sinkBoundary),toggleSinkBoundaryCheckbox.checked?sinkBoundary.show():sinkBoundary.hide()}function downloadURI(e,a){var n=document.createElement("a");n.download=a,n.href=e,document.body.appendChild(n),n.click(),document.body.removeChild(n),delete n}function CreateWorktop(){var e=parseInt(document.getElementById("lengthInput").value),a=parseInt(document.getElementById("depthInput").value),n=parseInt(25),r=parseInt(document.getElementById("corner_br").value),t=parseInt(document.getElementById("corner_fr").value),i=parseInt(document.getElementById("corner_bl").value),o=parseInt(document.getElementById("corner_fl").value);const l=document.getElementById("leftEdge").checked,d=document.getElementById("frontEdge").checked,g=document.getElementById("rightEdge").checked,c=document.getElementById("backEdge").checked;backLeftCurveYes=i>0,backRightCurveYes=r>0,frontRightCurveYes=t>0,frontLeftCurveYes=o>0;var m=document.getElementById("sinkRequiredSelect"),s=m.options[m.selectedIndex].value,u=document.getElementById("sinkBowlTypeSelect"),v=u.options[u.selectedIndex].value;if(isSinkRequired="yes"===s,imgDataUrl&&e&&a&&n&&r>=0&&t>=0&&i>=0&&o>=0){var h=coloursList.find((e=>e.name===imgName)).invertGrid,y=coloursList.find((e=>e.name===imgName)).invertcolours,f=0,k=0,p=0,I=0;(backLeftCurveYes||frontLeftCurveYes)&&(f=i>o?i:o),(backRightCurveYes||frontRightCurveYes)&&(k=r>t?r:t),(backLeftCurveYes||frontLeftCurveYes)&&(p=i>o?i:o),(backRightCurveYes||frontRightCurveYes)&&(I=r>t?r:t),a>2*defaultAllSides+defaultSinkLength+f&&!frontLeftCurveYes&&(f=0,p=0),a>2*defaultAllSides+defaultSinkLength+k&&!frontRightCurveYes&&(k=0,I=0),CreateCanvas(e,a,h),createHRuler(e),createVRuler(a);var L=new Image;L.src=imgDataUrl,L.onload=function(){var n=new Konva.Group,m=new Konva.Rect({width:e,height:a,fill:"transparent"}),s=new Konva.Rect({x:2.5,y:2.5,width:e-5,height:a-5,cornerRadius:[i,r,t,o],fillPatternImage:L,fillPatternScale:{x:1,y:1},fillPatternOffset:{x:-2.5,y:-2.5},stroke:"blue",strokeWidth:5}),u=l?5:0,v=c?5:0,h=g&&l?10:g?5:0,y=d&&c?10:d?5:0,p=new Konva.Rect({x:u,y:v,width:e-h,height:a-y,cornerRadius:[i,r,t,o],fillPatternImage:L,strokeWidth:5});n.add(m),n.add(s),n.add(p),layer.add(n),layer.batchDraw(),!0===isSinkRequired&&addSinkBoundary(e,a,f,k)};let n=defaultAllSides+p+(e-2*defaultAllSides-(f+k)-defaultSinkWidth)/2;document.getElementById("sinkOffSet").value=0;const m=new Konva.Image({x:defaultAllSides+p+(e-2*defaultAllSides-(f+k)-defaultSinkWidth)/2,y:a-defaultSinkLength-defaultAllSides,draggable:!0,dragBoundFunc:function(r){var t=Math.max(defaultAllSides+p,Math.min(r.x,e-defaultSinkWidth-I-defaultAllSides)),i=Math.max(a-defaultSinkLength-defaultAllSides,Math.min(r.y,a-defaultSinkWidth));return document.getElementById("sinkOffSet").value=Math.round(m.x())-n,{x:t,y:i}}});!1===isSinkRequired&&(document.getElementById("sinkOffSet").value="");const s=new Image;s.src="./images/sample-sink-right.png",s.onload=function(){if(m.image(s),"leftHB"===v){var e=MirrorImage(s);m.image(e)}m.cache(),!0===y&&m.filters([Konva.Filters.Invert]),!0===isSinkRequired&&layer.add(m),layer.draw()},joinLines(),layer.batchDraw()}else alert("Please check colour, length, depth, corner radius values")}function MirrorImage(e){let a=document.createElement("canvas"),n=a.getContext("2d");a.width=e.width,a.height=e.height,n.scale(-1,1),n.drawImage(e,-e.width,0);let r=new Image;return r.src=a.toDataURL(),r}const leftLargeCornerToggle=document.getElementById("leftLargeCorner");leftLargeCornerToggle.addEventListener("click",(function(e){let a=parseInt(document.getElementById("depthInput").value);if(!(a>=0))return alert("Please check depth value"),e.preventDefault(),e.stopPropagation(),!1;document.getElementById("leftLargeCorner").checked?(document.getElementById("corner_fl").disabled=!0,document.getElementById("corner_bl").disabled=!0,document.getElementById("corner_fl").value=a/2,document.getElementById("corner_bl").value=a/2):(document.getElementById("corner_fl").disabled=!1,document.getElementById("corner_bl").disabled=!1)}));const rightLargeCornerToggle=document.getElementById("rightLargeCorner");rightLargeCornerToggle.addEventListener("click",(function(e){let a=parseInt(document.getElementById("depthInput").value);if(!(a>=0))return alert("Please check depth value"),e.preventDefault(),e.stopPropagation(),!1;document.getElementById("rightLargeCorner").checked?(document.getElementById("corner_fr").disabled=!0,document.getElementById("corner_br").disabled=!0,document.getElementById("corner_fr").value=a/2,document.getElementById("corner_br").value=a/2):(document.getElementById("corner_fr").disabled=!1,document.getElementById("corner_br").disabled=!1)}));